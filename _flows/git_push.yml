id: git_push
namespace: company

inputs:
  - id: branch
    type: STRING
    defaults: develop

tasks:
  - id: push_flows
    type: io.kestra.plugin.git.PushFlows
    sourceNamespace: "{{flow.namespace}}"
    targetNamespace: "company"
    includeChildNamespaces: true
    flows: "*"
    url: https://github.com/paulgrainger85/kestra
    branch: "{{inputs.branch}}"
    username: "{{secret('git_username')}}"
    password: "{{secret('git_token')}}"
    commitMessage: "Adding flows for demo {{now()}} execID={{execution.id}}"
  - id: push_namespace_files
    type: io.kestra.plugin.git.SyncNamespaceFiles
    url: https://github.com/paulgrainger85/kestra
    gitDirectory: python
    branch: "{{inputs.branch}}"
    username: "{{secret('git_username')}}"
    password: "{{secret('git_token')}}"    